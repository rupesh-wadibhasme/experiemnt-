import os
import unittest
from backend.chatbot import TextExtractorDOCX, FileObject  # adjust paths

class TestTextExtractorDOCX(unittest.TestCase):
    def setUp(self):
        self.sample_file = "sample.docx"
        if not os.path.exists(self.sample_file):
            self.skipTest("sample.docx not found")
        self.extractor = TextExtractorDOCX()
        self.file = FileObject(self.sample_file)

    def test_extract_returns_textchunk(self):
        chunks = self.extractor.extract(self.file)
        self.assertIsInstance(chunks, list)
        self.assertIsInstance(chunks[0].text, str)
        self.assertGreater(len(chunks[0].text), 0)

    def test_heading_format(self):
        chunks = self.extractor.extract(self.file)
        self.assertIn("#", chunks[0].text)

if __name__ == "__main__":
    unittest.main()
